<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Unemployment Central</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Pacifico&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="styles.css">
</head>

<body>
	<div class="constellation-bg" id="constellation"></div>

	<div class="container" id="homepage">
		<div class="logo">
			<i class="bi bi-lightning-charge-fill logo-icon"></i>
			<span>unemployment central</span>
		</div>

		<div class="search-wrapper">
			<form id="search" class="search-box">
				<div class="search-input-wrapper">
					<i class="bi bi-search search-icon"></i>
					<input id="url" type="text" class="search-input" placeholder="Search or enter a site URL">
        </div>
			</form>
		</div>

		<div class="settings-link" onclick="openSettings()">
			<i class="bi bi-gear"></i>
			<span>Settings</span>
		</div>

		<div class="random-message" id="randomMessage">go get a life</div>

		<div class="quick-apps">
			<a href="#" class="app-button" onclick="loadUrl('https://youtube.com'); return false;">
				<div class="app-icon" style="background: #FF0000; color: white;">
					<i class="bi bi-play-fill"></i>
				</div>
				<div>YouTube</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://github.com'); return false;">
				<div class="app-icon" style="background: #24292e; color: white;">
					<i class="bi bi-github"></i>
				</div>
				<div>GitHub</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://discord.com'); return false;">
				<div class="app-icon" style="background: #5865F2; color: white;">
					<i class="bi bi-discord"></i>
				</div>
				<div>Discord</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://tiktok.com'); return false;">
				<div class="app-icon" style="background: linear-gradient(45deg, #00f2ea, #ff0050); color: white;">
					<i class="bi bi-music-note-beamed"></i>
				</div>
				<div>TikTok</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://google.com'); return false;">
				<div class="app-icon" style="background: linear-gradient(45deg, #4285F4, #EA4335); color: white;">
					<i class="bi bi-google"></i>
				</div>
				<div>Google</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://x.com'); return false;">
				<div class="app-icon" style="background: #000000; color: white;">
					<i class="bi bi-twitter-x"></i>
				</div>
				<div>Twitter/X</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://roblox.com'); return false;">
				<div class="app-icon" style="background: #000000; color: white;">
					<i class="bi bi-controller"></i>
				</div>
				<div>Games</div>
			</a>
			<a href="#" class="app-button" onclick="loadUrl('https://nvidia.com/geforce-now'); return false;">
				<div class="app-icon" style="background: #76B900; color: white;">
					<i class="bi bi-lightning-charge-fill"></i>
				</div>
				<div>GeForce Now</div>
			</a>
		</div>
	</div>

	<div class="settings-modal" id="settingsModal">
		<div class="settings-content">
			<div class="settings-header">
				<div class="settings-title">
					<i class="bi bi-gear-fill"></i>
					Settings
				</div>
				<button class="close-btn" onclick="closeSettings()">
          <i class="bi bi-x-lg"></i>
        </button>
			</div>

			<div class="setting-group">
				<label class="setting-label">WISP Server URL</label>
				<input id="websocket" type="text" class="setting-input" placeholder="wss://gointospace.app/wisp/" value="wss://gointospace.app/wisp/">
      </div>

				<div class="setting-group">
					<label class="setting-label">Tab Title (Cloaking)</label>
					<input id="tabTitle" type="text" class="setting-input" placeholder="Google">
      </div>

					<div class="setting-group">
						<label class="setting-label">Panic Key (Press to quick exit)</label>
						<input id="panicKey" type="text" class="setting-input" placeholder="Press a key..." readonly>
      </div>

						<button class="save-btn" onclick="saveSettings()">Save Settings</button>

						<button class="about-blank-btn" onclick="openInAboutBlank()">
        <i class="bi bi-box-arrow-up-right"></i>
        <span>Open in about:blank</span>
      </button>
					</div>
				</div>

				<div class="iframe-wrapper" id="iframeWrapper">
					<iframe id="iframe"></iframe>
				</div>

				<script src="main.js"></script>
				<script src="scramjet/scramjet.all.js" defer>
				</script>
				<script type="module" defer>
					import * as BareMux from "https://cdn.jsdelivr.net/npm/@mercuryworkshop/bare-mux/dist/index.mjs";
    const { ScramjetController } = $scramjetLoadController();
    const scramjet = new ScramjetController({ 
      prefix: "/scramjet/",
      files: { 
        wasm: "scramjet/wasm.wasm", 
        all: "scramjet/scramjet.all.js", 
        sync: "scramjet/scramjet.sync.js" 
      } 
    });
    
    scramjet.init();
    const swPath = window.location.pathname.split('/')[1] ? `/${window.location.pathname.split('/')[1]}/sw.js` : '/sw.js';
    navigator.serviceWorker.register(swPath);
    
    const connection = new BareMux.BareMuxConnection("/bareworker.js");
    
    function getWispUrl() {
        const wisp = document.getElementById("websocket").value.trim();
        const savedWisp = localStorage.getItem('wispUrl');
        const defaultWisp = "wss://gointospace.app/wisp/";
        return wisp || savedWisp || defaultWisp;
    }
    
    async function setTransport(transportsel) {
      const wispUrl = getWispUrl();
      switch (transportsel) {
        case "epoxy":
          await connection.setTransport("https://cdn.jsdelivr.net/npm/@mercuryworkshop/epoxy-transport/dist/index.mjs", [{ wisp: wispUrl }]);
          break;
        case "libcurl":
          await connection.setTransport("https://cdn.jsdelivr.net/npm/@mercuryworkshop/libcurl-transport/dist/index.mjs", [{ websocket: wispUrl }]);
          break;
        default:
          await connection.setTransport("https://cdn.jsdelivr.net/npm/@mercuryworkshop/epoxy-transport/dist/index.mjs", [{ wisp: wispUrl }]);
          break;
      }
    }
    
    window.setTransport = setTransport;

    window.search = function(input) {
      let template = "https://search.brave.com/search?q=%s";

      try {
        return new URL(input).toString();
      } catch (err) {}

      try {
        let url = new URL(`http://${input}`);
        if (url.hostname.includes(".")) return url.toString();
      } catch (err) {}

      return template.replace("%s", encodeURIComponent(input)); 
    }

    setTransport("epoxy");
    
    document.getElementById("search").addEventListener("submit", async (event) => {
      event.preventDefault();
      let fixedurl = search(document.getElementById("url").value);
      let src = scramjet.encodeUrl(fixedurl);
      document.getElementById('iframe').src = src;
      document.getElementById('iframeWrapper').classList.add('active');
      document.getElementById('homepage').style.display = 'none';
    });
  </script>
</body>

</html>
